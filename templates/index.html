<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Your Friend AI</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0f172a; margin:0; }
    .wrap { max-width: 800px; margin: 0 auto; padding: 24px; }
    .card { background:#111827; border:1px solid #1f2937; border-radius:14px; overflow:hidden; }
    .header { padding:16px 18px; border-bottom:1px solid #1f2937; color:#fff; }
    .header h1 { margin:0; font-size:18px; }
    .header p { margin:6px 0 0; color:#9ca3af; font-size:12px; }
    #chat { height: 70vh; overflow-y:auto; padding: 16px; display:flex; flex-direction:column; gap:10px; }
    .msg { max-width: 75%; padding: 10px 12px; border-radius: 14px; line-height:1.4; }
    .you { align-self:flex-end; background:#2563eb; color:#fff; border-bottom-right-radius:4px; }
    .bot { align-self:flex-start; background:#1f2937; color:#e5e7eb; border-bottom-left-radius:4px; }
    .typing { opacity:.7; font-style: italic; }
    .footer { display:flex; gap:10px; padding:14px; border-top:1px solid #1f2937; }
    #message { flex:1; padding:12px; border-radius:10px; border:1px solid #374151; background:#0b1220; color:#fff; outline:none; }
    button { padding: 12px 16px; border:0; border-radius:10px; background:#22c55e; color:#0b1220; font-weight:700; cursor:pointer; }
    button:disabled { opacity:.5; cursor:not-allowed; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <h1>ðŸ¤– Your Friend AI</h1>
        <p>Created by Hashan Withana â€¢ Ask anything</p>
      </div>

      <div id="chat"></div>

      <div class="footer">
        <input id="message" placeholder="Type a message..." />
        <button id="sendBtn" onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <script>
    const chatBox = document.getElementById("chat");
    const input = document.getElementById("message");
    const sendBtn = document.getElementById("sendBtn");

    function addMsg(text, cls) {
      const div = document.createElement("div");
      div.className = `msg ${cls}`;
      div.textContent = text;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
      return div;
    }

    async function sendMessage() {
      const message = input.value.trim();
      if (!message) return;

      addMsg(message, "you");
      input.value = "";
      input.focus();

      sendBtn.disabled = true;
      const typing = addMsg("Typing...", "bot typing");

      try {
        const response = await fetch("/api/chat", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({message})
        });

        const data = await response.json();
        typing.remove();
        addMsg(data.reply || data.error || "No reply", "bot");
      } catch (e) {
        typing.remove();
        addMsg("Server error. Try again.", "bot");
      } finally {
        sendBtn.disabled = false;
      }
    }

    // Enter key send
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    // Welcome
    addMsg("Hi! I'm Your Friend AI. How can I help you today?", "bot");
  </script>
</body>
</html>
